<view class="container">
  <view class="header-section">
    <view class="user-row" bindtap="{{userInfo ? '' : 'goLogin'}}">
      <view class="avatar-box">
         <image class="avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill" wx:if="{{userInfo.avatar || userInfo}}"></image>
         <view class="avatar-placeholder" wx:else>👤</view>
      </view>
      
      <view class="user-meta" wx:if="{{userInfo}}">
        <view class="name-row">
           <text class="nickname">{{userInfo.nickname || userInfo.username}}</text>
           <view class="vip-badge" wx:if="{{isVip}}">👑 大神卡</view>
        </view>
        <view class="phone">{{userInfo.phone || '登录享受更多权益'}}</view>
      </view>

      <view class="user-meta" wx:else>
        <view class="nickname">点击登录/注册</view>
        <view class="phone">登录后查看优惠券</view>
      </view>
    </view>
    
    <view class="vip-banner-bar" wx:if="{{!isVip}}" bindtap="goVip">
      <view class="bar-left">
        <text class="bar-close">×</text>
        <text class="bar-text">开通会员卡享更多福利</text>
      </view>
      <view class="bar-btn">去开通</view>
    </view>
  </view>

  <view class="vip-card-container" bindtap="goVip">
    
    <view class="vip-card black-gold" wx:if="{{isVip}}">
      <view class="card-header">
        <view class="card-title-box">
          <text class="card-title gold-text">♛ 尊贵大神卡会员</text>
          <text class="card-subtitle gold-text">有效期至：{{vipExpireText || '长期有效'}}</text>
        </view>
        <view class="card-btn-round gold-btn">会员权益 ></view>
      </view>
      <view class="benefits-row">
        <view class="benefit-text gold-text">全场 8 折</view>
        <view class="benefit-text gold-text">专属客服</view>
        <view class="benefit-text gold-text">极速退款</view>
      </view>
    </view>

    <view class="vip-card" wx:else>
      <view class="card-header">
        <view class="card-title-box">
          <text class="card-title">大神卡</text>
          <text class="card-subtitle">开通最高省¥40/天</text>
        </view>
        <view class="card-btn-round">立即开通 ></view>
      </view>
      
      <view class="benefits-row">
        <view class="benefit-item">
          <view class="benefit-icon">🎁</view>
          <view class="benefit-text">到店四件套</view>
        </view>
        <view class="benefit-item">
          <view class="benefit-icon">🛵</view>
          <view class="benefit-text">外送四件套</view>
        </view>
        <view class="benefit-item">
          <view class="benefit-icon">☕</view>
          <view class="benefit-text">咖啡6元起</view>
        </view>
        <view class="benefit-item">
          <view class="benefit-icon">☀️</view>
          <view class="benefit-text">早餐6折起</view>
        </view>
      </view>
    </view>
  </view>

  <view class="stats-card">
    <view class="stat-item">
      <view class="stat-num">1990</view>
      <view class="stat-label"><text class="coin-icon">V</text> 金</view>
    </view>
    <view class="stat-item">
      <view class="stat-num">{{vouchers.length || 0}}<text class="stat-unit">张</text></view>
      <view class="stat-label">卡券</view>
    </view>
    <view class="stat-item">
      <view class="stat-num">{{userInfo.balance || 0}}<text class="stat-unit">元</text></view>
      <view class="stat-label">余额</view>
    </view>
  </view>

  <view class="menu-card">
    <view class="menu-header">常用功能</view>
    <view class="menu-grid">
      <view class="menu-item" bindtap="goToOrders">
        <view class="menu-icon-img">📄</view>
        <view class="menu-text">我的订单</view>
      </view>
      <view class="menu-item" bindtap="goToAddress">
        <view class="menu-icon-img">📍</view>
        <view class="menu-text">送餐地址</view>
      </view>
      <view class="menu-item">
        <view class="menu-icon-img">🧾</view>
        <view class="menu-text">发票助手</view>
      </view>
      <view class="menu-item">
        <view class="menu-icon-img">🎧</view>
        <view class="menu-text">在线客服</view>
      </view>
    </view>
  </view>

  <view class="list-card">
    <view class="list-item" bindtap="goToAdminLogin">
      <view class="list-left">
        <text class="list-icon">🔧</text>
        <text class="list-text">商家管理后台</text>
      </view>
      <text class="list-arrow">></text>
    </view>
  </view>

  <view class="logout-btn" wx:if="{{userInfo}}" bindtap="handleLogout">退出登录</view>
</view>