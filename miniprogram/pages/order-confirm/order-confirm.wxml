<view class="container">
  <!-- 1. 顶部：配送/自取信息 -->
  <view class="header-card">
    <block wx:if="{{orderType === 'takeout'}}">
      <view class="row title-row">
        <text class="title">外送订单</text>
        <text class="badge">KFC宅急送</text>
      </view>
      <view class="address-box" bindtap="reselectAddress">
        <view class="addr-detail">{{address.detail}}</view>
        <view class="addr-user">{{address.consignee}} {{address.phone}}</view>
        <view class="arrow">></view>
      </view>
      <view class="time-row">
        <text>预计送达</text>
        <text class="time">尽快送达 (预计30分钟)</text>
      </view>
    </block>
    
    <block wx:else>
      <view class="row title-row">
        <text class="title">到店自取</text>
        <text class="badge">极速免排队</text>
      </view>
      <view class="shop-box">
        <view class="shop-name">{{shop.name}}</view>
        <view class="shop-addr">{{shop.address}}</view>
      </view>
      <view class="time-row">
        <text>取餐时间</text>
        <text class="time">现在下单，预计10分钟后可取</text>
      </view>
      <view class="dine-options">
          <view class="opt {{dineOption==='in'?'active':''}}" bindtap="setDineOption" data-opt="in">堂食</view>
          <view class="opt {{dineOption==='out'?'active':''}}" bindtap="setDineOption" data-opt="out">外带</view>
      </view>
    </block>
  </view>

  <!-- 2. 餐品列表 -->
  <view class="order-card">
    <view class="shop-title">{{shop.name}}</view>
    <block wx:for="{{cartList}}" wx:key="cartId">
      <view class="order-item">
        <image class="item-img" src="{{item.image}}"></image>
        <view class="item-info">
          <view class="item-name">{{item.name}}</view>
          <view class="item-spec">{{item.specString || ''}}</view>
          <view class="item-count">x{{item.quantity}}</view>
        </view>
        <view class="item-price">¥{{item.price}}</view>
      </view>
    </block>
    <view class="total-row">
      <text>小计</text>
      <text class="total-price">¥{{totalPrice}}</text>
    </view>
  </view>

  <!-- 3. 底部支付栏 -->
  <view class="footer-bar">
    <view class="price-box">
      <text>合计</text>
      <text class="final-price">¥{{totalPrice}}</text>
    </view>
    <button class="pay-btn" bindtap="submitOrder">提交订单</button>
  </view>
</view>